/* Theme: Cute, soft green aesthetic with cozy, romantic design */
:root {
  --mint: #b8e2c8;
  --mint-200: #cfead9;
  --mint-300: #a9d9bd;
  --mint-500: #7ec79b;
  --mint-600: #66b287;
  --text: #173b2a;
  --white: #ffffff;
  --shadow: rgba(23, 59, 42, 0.18);
  --glass: rgba(255, 255, 255, 0.28);
  --glass-border: rgba(255, 255, 255, 0.45);
  --key-size: clamp(56px, 9vw, 72px);
}

* {
  box-sizing: border-box;
}

html, body {
  height: 100%;
}

body.theme-mint {
  margin: 0;
  font-family: 'Nunito', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
  color: var(--text);
  background: linear-gradient(180deg, var(--mint-200), var(--mint-300));
  overflow: hidden;
}

/* Background slideshow */
#bg-slideshow {
  position: fixed;
  inset: 0;
  z-index: -2;
  overflow: hidden;
}

/* Dome Gallery background layer (interactive, behind hearts) */
#bg-gallery {
  position: fixed;
  inset: 0;
  z-index: -2; /* above slideshow, below hearts */
  overflow: hidden;
  perspective: 1200px;
}

#bg-gallery .track {
  position: absolute;
  left: 50%;
  top: 52%;
  transform-style: preserve-3d;
  transform: translate(-50%, -50%) rotateX(10deg);
}

#bg-gallery .overlay {
  position: absolute;
  inset: 0;
  pointer-events: none;
  background: radial-gradient(120% 120% at 50% 50%, rgba(6,0,16,0) 40%, rgba(6,0,16,0.35) 70%, rgba(6,0,16,0.6) 100%);
  mix-blend-mode: multiply;
}

:root { --tile-size: clamp(90px, 12vw, 140px); }
#bg-gallery .tile {
  position: absolute;
  width: var(--tile-size);
  height: var(--tile-size);
  border-radius: 18px;
  overflow: hidden;
  box-shadow: 0 10px 28px rgba(0,0,0,0.25);
  transform-style: preserve-3d;
  filter: grayscale(0.9) contrast(0.95) brightness(0.92);
}
#bg-gallery .tile img {
  width: 100%; height: 100%; object-fit: cover;
  transform: translateZ(0.1px);
}
#bg-gallery .tile:hover { filter: grayscale(0.2) contrast(1) brightness(1); }


#bg-slideshow::after {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(40% 60% at 50% 40%, rgba(184, 226, 200, 0.65) 0%, rgba(184, 226, 200, 0.35) 60%, rgba(184, 226, 200, 0.15) 85%, rgba(184, 226, 200, 0.05) 100%);
  mix-blend-mode: soft-light;
}

#bg-slideshow .slide {
  position: absolute;
  inset: 0;
  background-size: cover;
  background-position: center;
  filter: saturate(0.9) contrast(1.02) brightness(0.95) blur(0.5px);
  opacity: 0;
  transform: scale(1.06);
  transition: opacity 1400ms ease-in-out, transform 9s ease-out;
}

#bg-slideshow .slide.active {
  opacity: 1;
  transform: scale(1.03);
}

#bg-slideshow.fallback {
  background: linear-gradient(135deg, var(--mint-200), var(--mint-500));
}

/* Floating hearts overlay */
#hearts-layer {
  position: fixed;
  inset: 0;
  z-index: -1;
  pointer-events: none;
  opacity: 0;
  animation: overlayFadeIn 600ms ease 200ms forwards;
}


.heart {
  /* Size-aware heart using CSS variables */
  --size: 22px; /* default, overridden per element */
  position: absolute;
  width: var(--size);
  height: var(--size);
  transform: rotate(-45deg);
  background: var(--mint-500);
  filter: drop-shadow(0 4px 8px rgba(126, 199, 155, 0.25));
  opacity: 0.75;
  border-radius: calc(var(--size) * 0.28) 0 0 calc(var(--size) * 0.28);
  animation: floatY var(--dur, 10s) linear infinite, swayX calc(var(--dur, 10s) * 0.6) ease-in-out infinite;
}

.heart::before,
.heart::after {
  content: '';
  position: absolute;
  width: var(--size);
  height: var(--size);
  background: var(--mint-500);
  border-radius: 50%;
}
.heart::before {
  top: calc(var(--size) * -0.5);
  left: 0;
}
.heart::after {
  left: calc(var(--size) * 0.5);
  top: 0;
}

@keyframes floatY {
  0% { transform: translateY(20vh) rotate(-45deg); }
  100% { transform: translateY(-110vh) rotate(-45deg); }
}
@keyframes swayX {
  0% { margin-left: -8px; }
  50% { margin-left: 8px; }
  100% { margin-left: -8px; }
}

/* Gate layout: two columns (passcode left, gallery right) */
#gate {
  position: fixed;
  inset: 0;
  display: grid;
  grid-template-columns: minmax(300px, 480px) minmax(320px, 520px);
  align-items: center;
  justify-content: center;
  gap: 36px;
  padding: 24px;
}

/* Intro header above columns */
.intro { grid-column: 1 / -1; text-align: center; }
.intro-title {
  font-family: 'Satisfy', cursive;
  font-size: 2.2rem;
  margin: 0;
  color: var(--text);
  opacity: 0;
  animation: introDown 700ms ease 50ms forwards;
}
.intro-sub {
  margin: 4px 0 0;
  font-size: 1.05rem;
  font-weight: 600;
  opacity: 0.85;
  opacity: 0;
  animation: fadeUp 650ms ease 160ms forwards;
}

.card {
  width: 100%;
  max-width: 480px;
  background: var(--glass);
  border: 1px solid var(--glass-border);
  backdrop-filter: blur(14px) saturate(1.05);
  border-radius: 22px;
  box-shadow: 0 12px 32px var(--shadow);
  padding: 28px 28px 24px;
  transform: translateY(0);
  transition: transform 400ms ease, opacity 350ms ease;
  opacity: 0;
  animation: fadeUp 700ms ease 260ms forwards;
}

/* Right-side square stack gallery */
.stack-square {
  width: clamp(320px, 42vw, 520px);
  aspect-ratio: 1 / 1;
  position: relative;
  background: rgba(255, 255, 255, 0.22);
  border: 1px solid var(--glass-border);
  backdrop-filter: blur(10px) saturate(1.05);
  border-radius: 22px;
  box-shadow: 0 12px 32px var(--shadow);
  overflow: hidden;
  cursor: pointer;
  transition: transform 250ms ease, box-shadow 250ms ease;
  opacity: 0;
  animation: fadeUp 720ms ease 340ms forwards;
}

.stack-square .stack-card {
  position: absolute;
  inset: 10px;
  border-radius: 16px;
  background-size: cover;
  background-position: center;
  box-shadow: 0 10px 24px rgba(0,0,0,0.22);
  transform-origin: center;
  transition: transform 400ms ease, opacity 400ms ease, filter 300ms ease;
  will-change: transform, opacity;
}

.stack-square:hover { transform: translateY(-2px); box-shadow: 0 16px 36px rgba(0,0,0,0.26); }

.stack-square .stack-card::after {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(140% 140% at 50% 50%, rgba(0,0,0,0) 20%, rgba(0,0,0,0.25) 100%);
  mix-blend-mode: multiply;
}

/* Responsive: stack vertically on small screens */
@media (max-width: 860px) {
  #gate {
    grid-template-columns: 1fr;
    grid-auto-rows: max-content;
    gap: 22px;
  }
  .stack-square { width: clamp(280px, 80vw, 520px); justify-self: center; }
}

.title {
  font-family: 'Satisfy', cursive;
  font-size: 2rem;
  margin: 0 0 4px;
  color: var(--text);
  text-align: center;
}

/* Dots indicator */
.dots {
  display: flex;
  gap: 14px;
  margin: 14px 0 18px;
  justify-content: center;
  align-items: center;
}
.dot {
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.4);
  box-shadow: inset 0 0 0 2px rgba(23, 59, 42, 0.18);
  transition: background 200ms ease, transform 200ms ease;
  opacity: 0;
  animation: pop 420ms cubic-bezier(.22,.61,.36,1) forwards;
}
.dot:nth-child(1) { animation-delay: 380ms; }
.dot:nth-child(2) { animation-delay: 430ms; }
.dot:nth-child(3) { animation-delay: 480ms; }
.dot:nth-child(4) { animation-delay: 530ms; }
.dot.filled {
  background: radial-gradient(circle at 30% 30%, var(--mint-600), var(--mint-500));
  transform: scale(1.06);
  box-shadow: 0 0 0 2px rgba(23, 59, 42, 0.18);
}

/* Keypad */
.keypad {
  display: grid;
  grid-template-columns: repeat(3, var(--key-size));
  justify-content: center;
  gap: 16px 18px;
  margin: 6px 0 14px;
}
.spacer { width: var(--key-size); height: var(--key-size); }
.key {
  width: var(--key-size);
  height: var(--key-size);
  display: grid;
  place-items: center;
  border-radius: 50%;
  border: 1px solid rgba(23, 59, 42, 0.18);
  background: rgba(255, 255, 255, 0.45);
  color: var(--text);
  font-weight: 700;
  font-size: 1.25rem;
  cursor: pointer;
  box-shadow: 0 10px 20px rgba(126, 199, 155, 0.25);
  transition: transform 120ms ease, filter 120ms ease;
  opacity: 0;
  animation: keyIn 480ms cubic-bezier(.22,.61,.36,1) forwards;
}
.key:hover { transform: translateY(-1px); filter: brightness(1.05); }
.key:active { transform: translateY(0); }
.key.icon { background: rgba(255,255,255,0.35); }

/* Stagger keypad buttons by type position (buttons only) */
.keypad button.key:nth-of-type(1) { animation-delay: 420ms; }
.keypad button.key:nth-of-type(2) { animation-delay: 460ms; }
.keypad button.key:nth-of-type(3) { animation-delay: 500ms; }
.keypad button.key:nth-of-type(4) { animation-delay: 540ms; }
.keypad button.key:nth-of-type(5) { animation-delay: 580ms; }
.keypad button.key:nth-of-type(6) { animation-delay: 620ms; }
.keypad button.key:nth-of-type(7) { animation-delay: 660ms; }
.keypad button.key:nth-of-type(8) { animation-delay: 700ms; }
.keypad button.key:nth-of-type(9) { animation-delay: 740ms; }
.keypad button.key:nth-of-type(10) { animation-delay: 780ms; }
.keypad button.key:nth-of-type(11) { animation-delay: 820ms; }

.hint {
  margin: 10px 0 0;
  font-size: 0.95rem;
  opacity: 0.7;
  text-align: center;
}

.message {
  min-height: 20px;
  margin: 8px 0 0;
  font-weight: 700;
}

#gate.granted .card { opacity: 0; transform: translateY(-12px); }

/* Keyframes */
@keyframes overlayFadeIn { from { opacity: 0; } to { opacity: 1; } }
@keyframes fadeUp { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }
@keyframes introDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
@keyframes keyIn { from { opacity: 0; transform: scale(0.92) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }
@keyframes pop { from { opacity: 0; transform: scale(0.7); } to { opacity: 1; transform: scale(1); } }

/* Respect reduced motion: minimize animations */
@media (prefers-reduced-motion: reduce) {
  .intro-title, .intro-sub, .card, .stack-square, .dot, .key, #hearts-layer { animation: none; opacity: 1; transform: none; }
}

/* Reduced motion respect */
@media (prefers-reduced-motion: reduce) {
  #bg-slideshow .slide { transition: opacity 0.6s linear; transform: none; }
  .heart { animation: none; }
}